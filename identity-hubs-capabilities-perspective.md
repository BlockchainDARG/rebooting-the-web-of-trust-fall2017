**RWoT Identity Hubs Capabilities Perspective**

Adrian Gropper, Drummond Reed, Mark S. Miller

**Abstract**

Identity Hubs as currently proposed in DIF are a subset of a general DID
identity container because they are based on ACLs rather than an
object-capabilities (ocap) architecture. The current approach has both
security and scalability issues. Transitioning the Hubs design to an
ocap model can be achieved by introducing an UMA authorization server as
the control endpoint. This avoids creating confused deputy security
issues and expands scale by enabling the hub to delegate access to
resources not stored in the hub itself.

**Security and Privacy Impact Assessment**

Control over personal data is becoming more important as networking and
storage costs become negligible compared to the value of our data
itself. A prominent example of this is the EU General Data Protection
Regulations (GDPR) and Payment Services Directive (PSD2) that mandate
sweeping new responsibilities for transparency and control onto all
enterprises that hold personal data.

In general, personal data fits into three distinct categories:

-   Data generated by service or device (e.g.: a lab test of my anonymous blood sample or location streamed by my mobile device)

-   Data aggregated by a service (e.g.: a credit reporting enterprise)

-   Data aggregated by a fiduciary or self-sovereign agent (e.g.: a personal server that I own or a secure mobile wallet)

Identity threads through all aspects of access to personal data for

-   subject (we ignore guardians in this short paper) of the personal data, and

-   the parties seeking access to the personal data about the subject.

A scalable personal data architecture will guide the implementation of
secure and privacy-preserving services without the costs and risks of
unwanted aggregation.

**Self-Sovereign Identity**

The scale of a personal data architecture is limited by federation as a
root of trust. Standardized self-sovereign identity (e.g.: DID) uses
distributed public ledgers as a source of trust while retaining the
option, on a person-by-person basis, to accept federated identities.

Self-sovereign identity (and verifiable credentials) is useful for both
the subject and the requesting party. Both benefit from self-sovereign
mobile wallets with local biometric protections and from the ability to
sign documents in a legally non-repudiable manner.

Self-sovereign identity serves as the root of trust for the subject’s
identity containers and the root of trust for claims presented by a
requesting party to the subject’s identity container.

**Self-Sovereign Identity Container**

The essential component of the identity container is the ability to
authorize access to the subject’s resources by requesting parties. As
such, it secures the subject’s policies (the way a secure element
secures a subject’s private keys) and executes code to issue
authorization tokens (the way a secure element executes signatures).

To the extent that an identity container also hosts a database holding
data about the subject that can be shared with requesting parties,
access to that data is also under the control of the authorization
Server.

Implementation Example

Preamble:Subject Alice goes to have a 4 blood tests at resource service
Lab that will be made available, in the future, under her control to
various requesting parties. One of these requesting parties is Bob. Bob
has verifiable credentials as a licensed MD and a member of his temple.
Alice controls an authorization server (AS).

1.  Alice presets a policy in her AS that any MD can access anything other than “Sensitive” tests. This happens only once and applies to many transactions with many service providers. This can be inherited along with the code for the AS from a source that Alice trusts.

2.  Alice registers in-person at Lab and provides a blood sample and a pointer to her AS endpoint. The Lab registers 4 tests as 4 different resources with the AS. One of the resources has metadata STD. This happens only once regardless of how many times Alice gets lab tests at Lab. Time passes...

3.  Bob, using out-of-band directory interactions or a referral from someone, is given a pointer to Alice@Lab resources. Bob may or may not know that there are 4 of them at Lab.

4.  Bob goes to Lab to request the resources. He does not identify himself in any way. Lab looks up Alice’s AS endpoint and gives Bob, whoever he is, a pointer to the AS along with a ticket that captures the context of the transaction for later reference.

5.  Bob authenticates to Alice’s AS and presents the MD credentials but not his temple membership as his identity. The context ticket says he’s asking for 3 of the 4 results.

6.  Alice’s AS consults the policies and the metadata associated with the context ticket (as registered, or dynamically at the time of the request) and determines that one of the 3 tests is Sensitive. In some cases, metadata shows up that the AS does not understand and Alice herself may need to be consulted otherwise the process is automatic once Bob has submitted the ticket and the claims.

7.  The AS issues to Bob’s software client a token granting access to 2 of the 3 tests he requested. The token can be associated with OAuth refresh so that Bob will not need to re-authenticate for a year.

8.  Bob’s client presents the token to the Lab. The token can encode the permission for the 2 tests or the Lab can consult the AS to determine the scope of access associated with the token.

9.  The Lab exposes 2 of the 4 tests to Bob’s client.

-   Note that Alice can choose to move some or all of the Lab data to an aggregator because she considers the Lab to be unreliable beyond a certain time. If she does that, Alice will need to ensure that the lab test retains provenance and to Bob’s satisfaction and that represents a significant added cost.

-   Although delegating access control to an external AS is an added cost to the Lab, it is also a feature that attracts Alice as a customer and it reduces their legal liability under GDPR.

-   Note that Alice and Bob both have the ability to attenuate the scope of disclosure about them.

-   The only single point of failure is Alice’s AS which must be sufficiently reliable.

-   Alice has a single point of control for all of her participating services. A major convenience.

-   Alice can have as many AS endpoints as she wants separate personas. To avoid unwarranted correlation, the AS endpoint can go through a mixer or hub.

Token-based access control to RESTful APIs has been standardized as
OAuth2. The UMA standard builds on top of OAuth2 to enable the
separation of the authorization server from the resource server. The
subject authenticates into the authorization server of the identity
container in order to create or modify policies and to manage the code
that uses policies to respond to requesting parties. The requesting
parties bring tickets to the authorization server that represent the
context of a resource access request along with whatever credentials the
requesting party chooses to expose to the authorization server. The
requesting party then receives a limited scope access token to the
resource regardless of whether the resource is coresident in the
identity container or hosted by an independent enterprise.

**Proposal to DIF**

We propose an update of the DIF Identity Hub to specify OAuth2 and UMA
as the protection mechanisms of the hub. That would be followed by a
privacy impact assessment of all aspects of the Identity Hub
specification including specific reference to GDPR and PSD2 compliance.

**References**

**ACLs Don’t**
[*http://www.hpl.hp.com/techreports/2009/HPL-2009-20.pdf*](http://www.hpl.hp.com/techreports/2009/HPL-2009-20.pdf)

**UMA**
[*https://kantarainitiative.org/confluence/display/uma/Home*](https://kantarainitiative.org/confluence/display/uma/Home)

**DIF HUbs**
[*https://github.com/decentralized-identity/hubs/blob/master/explainer.md*](https://github.com/decentralized-identity/hubs/blob/master/explainer.md)
